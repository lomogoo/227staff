# Route 227s' Cafe Staff App - アプリケーション仕様書

## 概要

カフェの日次損益分岐点を計算するスタッフ向けWebアプリケーションです。従業員が勤務時間と売上目標（オプション）を入力すると、本日の営業に必要な販売杯数を自動計算します。

**アプリ名（英語）:** Route 227s' Cafe Staff App
**サブタイトル:** Daily Break-Even Calculator
**型式:** シングルページWebアプリケーション（HTML/CSS/JavaScript）
**対応環境:** モダンブラウザ（Chrome、Firefox、Safari等）
**デザイン:** Claude ライトモード風（ホワイトテーマ）

---

## 機能仕様

### 1. メイン機能：損益分岐点計算

#### 入力項目
- **勤務時間**（時間単位、必須）
  - ユーザーが本日の勤務時間を入力
  - 単位：時間（0.5時間刻み対応）

- **売上目標**（円単位、オプション）
  - ユーザーが本日の売上目標を任意で入力
  - 入力がない場合は損益分岐点のみ表示

#### 計算ロジック

**基本計算（常に表示）**
```
人件費 = 勤務時間 × 時給
1杯あたりの粗利 = 商品価格 - 1杯あたりの原価
損益分岐点杯数 = ⌈人件費 ÷ 1杯あたりの粗利⌉  （切り上げ）
損益分岐点売上 = 損益分岐点杯数 × 商品価格
```

**売上目標がある場合（追加表示）**
```
目標粗利額 = 売上目標額 × (1 - 原価率)
目標達成に必要な粗利 = 人件費 + 目標粗利額
目標達成に必要な杯数 = ⌈目標達成に必要な粗利 ÷ 1杯あたりの粗利⌉  （切り上げ）
```

#### 出力項目（常に表示）
- **損益分岐点杯数:** 赤字を回避するために必要な販売杯数
- **損益分岐点売上:** 対応する必要売上高（円）
- **人件費:** 本日の総人件費（勤務時間 × 時給）
- **1杯あたりの粗利:** 商品1杯からの粗利額

#### 出力項目（売上目標がある場合のみ表示）
- **目標粗利額:** 売上目標に対応する粗利額
- **目標達成に必要な杯数:** 売上目標と人件費を両方達成するための販売杯数

### 2. 管理者設定機能

#### アクセス方法
- アプリのタイトルを5回クリックするとシークレット管理画面を表示

#### 設定項目
1. **カレー価格** （デフォルト値: ¥800）
   - 1杯あたりの販売価格

2. **原価** （デフォルト値: ¥250）
   - 1杯あたりの原価（仕入れ原価等）

3. **原価率** （デフォルト値: 31.25%）
   - 売上に占める原価の割合（自動計算可能）

4. **時給** （デフォルト値: ¥1500）
   - 従業員の時給額

#### 設定の保存
- Supabaseデータベースに自動保存
- Supabase接続に失敗時はブラウザのローカルストレージに保存

---

## データ仕様

### データベース（Supabase）

**サービスURL:** `hccairtzksnnqdujalgv.supabase.co`
**テーブル名:** `curry_settings`

**テーブルスキーマ:**
| カラム名 | データ型 | 説明 |
|---------|---------|------|
| id | UUID | プライマリキー |
| curry_price | DECIMAL | カレー価格（円） |
| cost | DECIMAL | 原価（円） |
| cost_rate | DECIMAL | 原価率（%） |
| hourly_wage | DECIMAL | 時給（円） |
| updated_at | TIMESTAMP | 更新日時 |

### ローカルストレージ

**フォールバック用:** ブラウザのローカルストレージに設定値を保存

---

## UI/UX仕様

### デザイン

- **配色:** ライトテーマ（Claudeのライトモード準拠）
  - 背景: ホワイト（#ffffff）
  - テキスト: ダークグレー～ブラック（#0a0a0a）
  - セカンダリテキスト: グレー（#666666、#999999）
  - アクセント: ダークカラー（#0a0a0a）
  - サブセクション背景: ライトグレー（#f5f5f5）

- **デザインパターン:** シンプルでクリーンなデザイン
  - シャープなボーダーと明確な領域分割
  - 背景グラデーション: なし（平坦なホワイト）

### レスポンシブ対応

- **モバイル:** 対応
- **タブレット:** 対応
- **デスクトップ:** 対応

全デバイスで最適な表示を実現

### アニメーション

- スムーズなホバーエフェクト（カード、ボタン）
- フォーカス時の円形シャドウ
- モーダル表示のスライドアップアニメーション
- 背景グラデーション: なし

---

## 技術仕様

### 技術スタック

| 項目 | 内容 |
|------|------|
| HTML | HTML5 |
| CSS | Modern CSS3（カスタムプロパティ対応） |
| JavaScript | Vanilla JavaScript（フレームワーク不使用） |
| バックエンド | Supabase（PostgreSQL） |
| CDN | Supabase JavaScript SDK v2 |

### 外部依存関係

- **Supabase JS SDK:** CDNから読み込み（動的）

### ファイル構成

```
/home/user/227staff/
├── index.html          - メインアプリケーション（HTML+CSS+JS一体型）
├── SPECIFICATIONS.md   - 本仕様書
└── .git/              - Gitリポジトリメタデータ
```

---

## セキュリティ仕様

### 実装予定項目

- Supabase認証（現在: 認証なし）
- データ暗号化（現在: 未実装）
- HTTPS通信（本番環境）

### 現状

- 認証: なし（任意のユーザーが設定を変更可能）
- 設定はローカルストレージまたはSupabaseに保存

---

## ユーザーフロー

### 通常利用フロー

1. アプリを開く
2. **勤務時間** を入力
3. 損益分岐点が自動表示される
   - 損益分岐点杯数
   - 必要売上高
   - 人件費
   - 1杯あたりの粗利
4. **売上目標**（オプション）を入力
5. 目標達成に必要な杯数が表示される
   - 目標粗利額
   - 目標達成に必要な杯数

### 管理者設定フロー

1. アプリタイトルを5回連続クリック
2. 管理者設定モーダルが表示される
3. 各設定項目を変更
   - 商品価格
   - 原価
   - 原価率
   - 時給
4. **設定を保存** ボタンをクリック
5. Supabaseに保存（または ローカルストレージにフォールバック）
6. モーダルが自動に閉じてメイン画面に戻る

---

## パフォーマンス仕様

- **ページロード時間:** < 2秒
- **計算応答時間:** リアルタイム（< 100ms）
- **ファイルサイズ:** ~24.4 KB（index.htmlのみ）

---

## ブラウザ互換性

- Chrome 最新版
- Firefox 最新版
- Safari 最新版
- Edge 最新版

---

## 今後の拡張予定（参考）

- [ ] ユーザー認証機能
- [ ] 複数店舗対応
- [ ] 日別/月別の売上統計
- [ ] レポート出力機能
- [ ] 多言語対応
- [ ] PWA化（オフライン対応）

---

**最終更新:** 2025-11-13（v2.0）
**バージョン:** 2.0

## 変更履歴

### v2.0 (2025-11-13)
- UIをClaudeのライトモード風に変更
- 入力項目を勤務時間（必須）と売上目標（オプション）に統合
- 売上粗利額の計算式を実装（売上目標額 × (1 - 原価率)）
- 損益分岐点杯数と目標達成杯数の2つの指標を表示
- 背景グラデーションアニメーションを削除
- アプリタイトルを"Route 227s' Cafe Staff App"に変更

### v1.0 (2025-11-13)
- 初版リリース
- ダークテーマUIで実装
- Supabase統合
- 管理者設定機能
